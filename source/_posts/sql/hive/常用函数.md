---
    title: hive常用函数
    categories: hive
    tags:
    creator: cjq
    create_time: 2021/01/21

---

## 常用

##### 8位dt转10位

```from_unixtime(unix_timestamp(t.dt,'yyyymmdd'),'yyyy-mm-dd')```

##### 8位减1小时

dt格式2019120100
```from_unixtime(unix_timestamp(dt,'yyyyMMddHH') - 60*60, 'yyyy-MM-dd')```

##### 8位日期计算

```regexp_replace(date_sub(from_unixtime(unix_timestamp(t.dt,'yyyymmdd'),'yyyy-mm-dd'), 10), '-', '')```

##### 当前日期前一天



##### 保留2位小数

```round(123.4567, 2)```

##### 时间戳转换

```sql
select hour(from_unixtime(event_timestamp/1000,'yyyy-MM-dd HH:mm:ss')) hour_time, count(distinct session_id)
from mart_eif_flow.bas_log_sdk_waimai_c where dt='20201217' group by hour(from_unixtime(event_timestamp/1000,'yyyy-MM-dd HH:mm:ss')) order by hour_time
```



### 计算

##### 保留小数